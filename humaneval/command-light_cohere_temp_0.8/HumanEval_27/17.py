```python
def flip_case(string):
    return ''.join upper(). matter(string.lower() if string[os() else string.upper() if string.lower() else() else string)
```

def test_flip_case():
    assert flip_case('hello') == 'Hello'
    assert flip_case('HEllO') == 'olleH'
    assert flip_case('Hello') == 'hello'
    assert flip_case('Earth') == ' EarTh '
    assert flip_case(' Costello') == 'CostCell'
```
This script defines a function `flip_case` that takes a string as input and returns a modified string, where the characters' case (lowercase to uppercase, uppercase to lowercase) is toggled. 
The test function `test_flip_case` verifies that the `flip_case` function produces the correct output for given inputs, asserting that the output is correct and verifying the output of the function against a list of test strings.