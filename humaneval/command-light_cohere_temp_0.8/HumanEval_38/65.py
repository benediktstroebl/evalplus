This code provides a self-contained solution to the problem you described.